# Default values for avapigw.
# This is a YAML-formatted file.

# -- Global settings
global:
  # -- Image pull secrets for all images
  imagePullSecrets: []
  # -- Override the release name
  nameOverride: ""
  # -- Override the full release name
  fullnameOverride: ""

# -- Namespace configuration
namespace:
  # -- Create namespace
  create: true
  # -- Namespace name (defaults to release namespace)
  name: ""
  # -- Namespace labels
  labels: {}
  # -- Namespace annotations
  annotations: {}

# -- CRD configuration
crds:
  # -- Install CRDs
  install: true
  # -- Keep CRDs on chart uninstall
  keep: true

# -- RBAC configuration
rbac:
  # -- Create RBAC resources
  create: true

# -- Service Account configuration
serviceAccount:
  # -- Create service account
  create: true
  # -- Service account name
  name: ""
  # -- Service account annotations
  annotations: {}
  # -- Automount service account token
  automountServiceAccountToken: true

# -- Gateway Operator configuration
operator:
  # -- Enable operator deployment
  enabled: true
  # -- Number of replicas
  replicas: 1
  
  image:
    # -- Image repository
    repository: vyrodovalexey/avapigw-operator
    # -- Image pull policy
    pullPolicy: IfNotPresent
    # -- Image tag (defaults to chart appVersion)
    tag: ""
  
  # -- Resource requests and limits
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi
  
  # -- Node selector
  nodeSelector: {}
  
  # -- Tolerations
  tolerations: []
  
  # -- Affinity rules
  affinity: {}
  
  # -- Pod annotations
  podAnnotations: {}
  
  # -- Pod labels
  podLabels: {}
  
  # -- Pod security context
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1001
    runAsGroup: 1001
    fsGroup: 1001
  
  # -- Container security context
  securityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL
  
  # -- Leader election configuration
  leaderElection:
    enabled: true
    leaseDuration: 15s
    renewDeadline: 10s
    retryPeriod: 2s
  
  # -- Metrics configuration
  metrics:
    # -- Enable metrics
    enabled: true
    # -- Metrics port
    port: 8080
    # -- Service monitor for Prometheus Operator
    serviceMonitor:
      enabled: false
      interval: 30s
      scrapeTimeout: 10s
      labels: {}
  
  # -- Health probe configuration
  health:
    # -- Health probe port
    port: 8081
    # -- Liveness probe configuration
    livenessProbe:
      httpGet:
        path: /healthz
        port: health
      initialDelaySeconds: 15
      periodSeconds: 20
      timeoutSeconds: 5
      failureThreshold: 3
    # -- Readiness probe configuration
    readinessProbe:
      httpGet:
        path: /readyz
        port: health
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  
  # -- Extra environment variables
  extraEnv: []
  
  # -- Extra volume mounts
  extraVolumeMounts: []
  
  # -- Extra volumes
  extraVolumes: []
  
  # -- Extra arguments
  extraArgs: []

# -- Gateway configuration
gateway:
  # -- Enable gateway deployment
  enabled: true
  # -- Number of replicas
  replicas: 2
  
  image:
    # -- Image repository
    repository: vyrodovalexey/avapigw-gateway
    # -- Image pull policy
    pullPolicy: IfNotPresent
    # -- Image tag (defaults to chart appVersion)
    tag: ""
  
  # -- Resource requests and limits
  resources:
    limits:
      cpu: 1000m
      memory: 512Mi
    requests:
      cpu: 200m
      memory: 256Mi
  
  # -- Node selector
  nodeSelector: {}
  
  # -- Tolerations
  tolerations: []
  
  # -- Affinity rules
  affinity: {}
  
  # -- Pod annotations
  podAnnotations: {}
  
  # -- Pod labels
  podLabels: {}
  
  # -- Pod security context
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1001
    runAsGroup: 1001
    fsGroup: 1001
  
  # -- Container security context
  securityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL
  
  # -- Service configuration
  service:
    # -- Service type
    type: ClusterIP
    # -- HTTP port
    httpPort: 8080
    # -- Health port
    healthPort: 8081
    # -- Metrics port
    metricsPort: 9090
    # -- gRPC port
    grpcPort: 9091
    # -- TCP port
    tcpPort: 9092
    # -- TLS passthrough port
    tlsPort: 9443
    # -- Service annotations
    annotations: {}
  
  # -- Horizontal Pod Autoscaler configuration
  autoscaling:
    # -- Enable HPA
    enabled: false
    # -- Minimum replicas
    minReplicas: 2
    # -- Maximum replicas
    maxReplicas: 10
    # -- Target CPU utilization percentage
    targetCPUUtilizationPercentage: 80
    # -- Target memory utilization percentage
    targetMemoryUtilizationPercentage: 80
  
  # -- Pod Disruption Budget configuration
  podDisruptionBudget:
    # -- Enable PDB
    enabled: false
    # -- Minimum available pods
    minAvailable: 1
    # -- Maximum unavailable pods (alternative to minAvailable)
    # maxUnavailable: 1
  
  # -- Health probe configuration
  health:
    # -- Liveness probe configuration
    livenessProbe:
      httpGet:
        path: /healthz
        port: health
      initialDelaySeconds: 15
      periodSeconds: 20
      timeoutSeconds: 5
      failureThreshold: 3
    # -- Readiness probe configuration
    readinessProbe:
      httpGet:
        path: /readyz
        port: health
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  
  # -- Gateway configuration
  config:
    # -- Log level (debug, info, warn, error)
    logLevel: info
    # -- Log format (json, console)
    logFormat: json
    # -- Enable gRPC
    grpcEnabled: true
    # -- Enable TCP
    tcpEnabled: false
    # -- Enable TLS passthrough
    tlsPassthroughEnabled: false
    # -- Enable metrics
    metricsEnabled: true
    # -- Enable tracing
    tracingEnabled: false
  
  # -- Extra environment variables
  extraEnv: []
  
  # -- Extra volume mounts
  extraVolumeMounts: []
  
  # -- Extra volumes
  extraVolumes: []
  
  # -- Extra arguments
  extraArgs: []

# -- Webhook configuration
webhook:
  # -- Enable webhooks
  enabled: true
  # -- Webhook port
  port: 9443
  # -- Use self-signed certificates
  selfSignedCert: true
  # -- Certificate validity period
  certValidity: 8760h  # 1 year
  # -- Certificate rotation threshold
  certRotation: 720h   # 30 days
  # -- Failure policy (Fail or Ignore)
  failurePolicy: Fail
  # -- Timeout seconds
  timeoutSeconds: 10
  # -- Reinvocation policy
  reinvocationPolicy: Never

# -- Vault integration configuration
vault:
  # -- Enable Vault integration
  enabled: false
  # -- Vault server address
  address: "http://vault.vault.svc.cluster.local:8200"
  # -- Vault authentication role
  role: "avapigw"
  # -- Vault authentication path
  authPath: "kubernetes"
  # -- Vault namespace (enterprise only)
  namespace: ""
  # -- TLS configuration
  tls:
    # -- Skip TLS verification
    skipVerify: false
    # -- CA certificate secret name
    caSecretName: ""
    # -- CA certificate key in secret
    caSecretKey: "ca.crt"

# -- Ingress configuration
ingress:
  # -- Enable ingress
  enabled: false
  # -- Ingress class name
  className: ""
  # -- Ingress annotations
  annotations: {}
  # -- Ingress hosts
  hosts:
    - host: gateway.local
      paths:
        - path: /
          pathType: Prefix
  # -- TLS configuration
  tls: []

# -- Metrics configuration
metrics:
  # -- Enable metrics
  enabled: true
  # -- Service Monitor for Prometheus Operator
  serviceMonitor:
    # -- Enable ServiceMonitor
    enabled: false
    # -- ServiceMonitor namespace (defaults to release namespace)
    namespace: ""
    # -- Scrape interval
    interval: 30s
    # -- Scrape timeout
    scrapeTimeout: 10s
    # -- Additional labels
    labels: {}
    # -- Metric relabelings
    metricRelabelings: []
    # -- Relabelings
    relabelings: []

# -- Network policies
networkPolicy:
  # -- Enable network policies
  enabled: false
  # -- Ingress rules
  ingress: []
  # -- Egress rules
  egress: []

# -- Priority class name
priorityClassName: ""

# -- Topology spread constraints
topologySpreadConstraints: []

# -- DNS configuration
dnsPolicy: ClusterFirst
dnsConfig: {}

# -- Termination grace period
terminationGracePeriodSeconds: 30
